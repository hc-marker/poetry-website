import{_ as z,q as A,a as l,b as n,d as t,s as m,F as $,g as w,l as f,t as y,h as b,v as j,c as C,x as E,o as O,y as D,z as G,f as H,u as N,j as T,A as J,m as S,i as K,k as Q,p as W}from"./index-c8a6b03f.js";import{P as X}from"./PoemCard-5ecdc132.js";const Y={class:"category-filter"},Z={class:"filter-header"},ee={class:"categories"},te=["onClick"],se={class:"category-name"},ae={class:"category-count"},oe={key:0,class:"tags-section"},le={class:"tags"},ne=["onClick"],re={class:"sort-section"},ie={class:"sort-options"},ue=["onClick"],ce={__name:"CategoryFilter",props:{categories:{type:Array,required:!0},tags:{type:Array,required:!0}},setup(x){const o=A(),d=b("all"),u=b(""),v=b("date-desc"),p=[{value:"date-desc",label:"最新发布"},{value:"date-asc",label:"最早发布"},{value:"title",label:"标题顺序"}],r=c=>{d.value=c,k()},_=c=>{u.value=c,k()},P=c=>{v.value=c,k()},h=()=>{d.value="all",u.value="",v.value="date-desc",k()},k=()=>{const c={};d.value!=="all"&&(c.category=d.value),u.value&&(c.tag=u.value),v.value!=="date-desc"&&(c.sort=v.value),o.push({path:"/poems",query:c})};return(c,g)=>(l(),n("div",Y,[t("div",Z,[g[0]||(g[0]=t("h3",null,"分类浏览",-1)),d.value!=="all"||u.value?(l(),n("button",{key:0,class:"btn btn-outline",onClick:h}," 重置筛选 ")):m("",!0)]),t("div",ee,[(l(!0),n($,null,w(x.categories,i=>(l(),n("button",{key:i.id,class:f(["category-item",{active:d.value===i.id}]),onClick:V=>r(i.id)},[t("span",se,y(i.name),1),t("span",ae,y(i.count),1)],10,te))),128))]),x.tags.length>0?(l(),n("div",oe,[g[1]||(g[1]=t("h4",null,"热门标签",-1)),t("div",le,[(l(!0),n($,null,w(x.tags,i=>(l(),n("button",{key:i,class:f(["tag-item",{active:u.value===i}]),onClick:V=>_(i)},y(i),11,ne))),128))])])):m("",!0),t("div",re,[g[2]||(g[2]=t("h4",null,"排序方式",-1)),t("div",ie,[(l(),n($,null,w(p,i=>t("button",{key:i.value,class:f(["sort-item",{active:v.value===i.value}]),onClick:V=>P(i.value)},y(i.label),11,ue)),64))])])]))}},de=z(ce,[["__scopeId","data-v-163ca847"]]);const ve={class:"poems-page"},ye={class:"page-header"},ge={class:"container"},pe={class:"header-content"},me={class:"search-box"},fe={class:"container"},he={class:"poems-container"},be={class:"sidebar"},_e={class:"main-content"},ke={key:0,class:"filter-info"},qe={class:"filter-tags"},Ce={key:0,class:"filter-tag"},$e={key:1,class:"filter-tag"},we={key:2,class:"filter-tag"},xe={class:"sort-options"},Pe={class:"sort-by"},Ve={class:"view-toggle"},Me={key:2,class:"empty-state"},Fe={key:3,class:"pagination"},Te=["disabled"],Be=["onClick"],Le=["disabled"],De={class:"page-info"},B=6,Ne={__name:"Poems",setup(x){const o=j(),d=A(),u=b(""),v=b("grid"),p=b("date-desc"),r=b(1),_=C(()=>{let a=[...W];if(o.query.category&&o.query.category!=="all"&&(a=a.filter(e=>{const s={guti:"古体诗",ci:"词",fu:"赋",modern:"现代诗",prose:"散文"};return e.category===s[o.query.category]})),o.query.tag&&(a=a.filter(e=>e.tags.some(s=>s.toLowerCase().includes(o.query.tag.toLowerCase())))),o.query.search){const e=o.query.search.toLowerCase();a=a.filter(s=>s.title.toLowerCase().includes(e)||s.content.toLowerCase().includes(e)||s.description.toLowerCase().includes(e)||s.tags.some(q=>q.toLowerCase().includes(e)))}switch(p.value){case"date-desc":a.sort((e,s)=>new Date(s.date)-new Date(e.date));break;case"date-asc":a.sort((e,s)=>new Date(e.date)-new Date(s.date));break;case"title":a.sort((e,s)=>e.title.localeCompare(s.title,"zh-CN"));break}return a}),P=C(()=>o.query.category||o.query.tag||o.query.search),h=C(()=>Math.ceil(_.value.length/B)),k=C(()=>{const a=(r.value-1)*B,e=a+B;return _.value.slice(a,e)}),c=C(()=>{const a=[];let s=Math.max(1,r.value-Math.floor(2.5)),q=Math.min(h.value,s+5-1);q-s+1<5&&(s=Math.max(1,q-5+1));for(let F=s;F<=q;F++)a.push(F);return a}),g=()=>{if(u.value.trim())d.push({path:"/poems",query:{...o.query,search:u.value.trim()}});else{const a={...o.query};delete a.search,d.push({path:"/poems",query:a})}r.value=1},i=()=>{d.push({path:"/poems",query:{...o.query,sort:p.value}})},V=a=>{const e=S.find(s=>s.id===a);return e?e.name:a},M=a=>{const e={...o.query};delete e[a],d.push({path:"/poems",query:e}),r.value=1},L=()=>{d.push({path:"/poems"}),u.value="",r.value=1},R=a=>{r.value=a,window.scrollTo({top:0,behavior:"smooth"})},I=()=>{r.value>1&&(r.value--,window.scrollTo({top:0,behavior:"smooth"}))},U=()=>{r.value<h.value&&(r.value++,window.scrollTo({top:0,behavior:"smooth"}))};return E(()=>o.query,()=>{r.value=1,o.query.sort&&(p.value=o.query.sort),o.query.search&&(u.value=o.query.search)},{immediate:!0}),O(()=>{o.query.search&&(u.value=o.query.search),o.query.sort&&(p.value=o.query.sort)}),(a,e)=>(l(),n("div",ve,[t("div",ye,[t("div",ge,[t("div",pe,[e[8]||(e[8]=t("h1",null,"诗集浏览",-1)),t("p",null,"共 "+y(_.value.length)+" 篇作品",1),t("div",me,[e[7]||(e[7]=t("i",{class:"fas fa-search"},null,-1)),D(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),placeholder:"搜索诗词标题、内容或标签...",onInput:g},null,544),[[G,u.value]]),t("button",{class:"btn btn-primary",onClick:g}," 搜索 ")])])])]),t("div",fe,[t("div",he,[t("aside",be,[H(de,{categories:N(S),tags:N(K)},null,8,["categories","tags"])]),t("main",_e,[P.value?(l(),n("div",ke,[t("div",qe,[a.$route.query.category?(l(),n("span",Ce,[T(" 分类: "+y(V(a.$route.query.category))+" ",1),t("button",{onClick:e[1]||(e[1]=s=>M("category")),class:"remove-filter"},[...e[9]||(e[9]=[t("i",{class:"fas fa-times"},null,-1)])])])):m("",!0),a.$route.query.tag?(l(),n("span",$e,[T(" 标签: "+y(a.$route.query.tag)+" ",1),t("button",{onClick:e[2]||(e[2]=s=>M("tag")),class:"remove-filter"},[...e[10]||(e[10]=[t("i",{class:"fas fa-times"},null,-1)])])])):m("",!0),a.$route.query.search?(l(),n("span",we,[T(' 搜索: "'+y(a.$route.query.search)+'" ',1),t("button",{onClick:e[3]||(e[3]=s=>M("search")),class:"remove-filter"},[...e[11]||(e[11]=[t("i",{class:"fas fa-times"},null,-1)])])])):m("",!0)]),P.value?(l(),n("button",{key:0,onClick:L,class:"btn btn-outline"}," 清除所有筛选 ")):m("",!0)])):m("",!0),t("div",xe,[t("div",Pe,[e[13]||(e[13]=t("span",null,"排序方式:",-1)),D(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>p.value=s),onChange:i},[...e[12]||(e[12]=[t("option",{value:"date-desc"},"最新发布",-1),t("option",{value:"date-asc"},"最早发布",-1),t("option",{value:"title"},"标题顺序",-1)])],544),[[J,p.value]])]),t("div",Ve,[t("button",{class:f({active:v.value==="grid"}),onClick:e[5]||(e[5]=s=>v.value="grid"),title:"网格视图"},[...e[14]||(e[14]=[t("i",{class:"fas fa-th-large"},null,-1)])],2),t("button",{class:f({active:v.value==="list"}),onClick:e[6]||(e[6]=s=>v.value="list"),title:"列表视图"},[...e[15]||(e[15]=[t("i",{class:"fas fa-list"},null,-1)])],2)])]),_.value.length>0?(l(),n("div",{key:1,class:f(["poems-grid",v.value])},[(l(!0),n($,null,w(k.value,s=>(l(),Q(X,{key:s.id,poem:s,class:f(v.value)},null,8,["poem","class"]))),128))],2)):(l(),n("div",Me,[e[16]||(e[16]=t("i",{class:"fas fa-book-open fa-3x"},null,-1)),e[17]||(e[17]=t("h3",null,"未找到相关作品",-1)),e[18]||(e[18]=t("p",null,"尝试调整筛选条件或搜索关键词",-1)),t("button",{onClick:L,class:"btn btn-primary"}," 显示所有作品 ")])),h.value>1?(l(),n("div",Fe,[t("button",{onClick:I,disabled:r.value===1,class:"pagination-btn"},[...e[19]||(e[19]=[t("i",{class:"fas fa-chevron-left"},null,-1)])],8,Te),(l(!0),n($,null,w(c.value,s=>(l(),n("button",{key:s,onClick:q=>R(s),class:f([{active:r.value===s},"pagination-btn"])},y(s),11,Be))),128)),t("button",{onClick:U,disabled:r.value===h.value,class:"pagination-btn"},[...e[20]||(e[20]=[t("i",{class:"fas fa-chevron-right"},null,-1)])],8,Le),t("span",De," 第 "+y(r.value)+" 页，共 "+y(h.value)+" 页 ",1)])):m("",!0)])])])]))}},Ae=z(Ne,[["__scopeId","data-v-fd1b5864"]]);export{Ae as default};
