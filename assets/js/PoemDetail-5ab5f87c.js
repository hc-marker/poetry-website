import{_ as O,v as V,c as y,o as $,p as i,r as H,a as o,b as r,d as t,f as J,w as v,t as l,j as d,l as x,s as w,F as C,g as I,k as p,h}from"./index-c8a6b03f.js";import{P as T}from"./PoemCard-5ecdc132.js";const L={class:"poem-detail"},j={class:"container"},q={class:"container"},E={class:"poem-content card"},M={class:"poem-header"},R={class:"poem-meta"},A={class:"poem-category"},G={class:"poem-date"},K={class:"poem-title"},Q={class:"poem-author"},U={class:"poem-body"},W={key:0,class:"poem-description"},X={class:"poem-tags"},Y={class:"tags"},Z={class:"poem-actions"},tt={class:"poem-navigation"},et={class:"nav-info"},st={class:"nav-title"},at={key:1,class:"nav-link placeholder"},ot={class:"nav-info"},lt={class:"nav-title"},nt={key:3,class:"nav-link placeholder"},it={key:0,class:"related-poems"},rt={class:"related-grid"},ct={__name:"PoemDetail",setup(ut){const S=V(),a=h({}),m=h("font-medium"),u=h(!1),P=s=>{switch(s){case"古体诗":case"回文诗":return"poem-classical";case"词":return"poem-ci";case"现代诗":return"poem-modern";default:return""}},f=y(()=>{const s=i.findIndex(e=>e.id===a.value.id);return s>0?i[s-1]:null}),_=y(()=>{const s=i.findIndex(e=>e.id===a.value.id);return s<i.length-1?i[s+1]:null}),k=y(()=>a.value.id?i.filter(s=>s.id!==a.value.id).filter(s=>s.category===a.value.category||s.tags.some(e=>a.value.tags.includes(e))).slice(0,3):[]),N=s=>new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),D=()=>{const s=["font-small","font-medium","font-large"],e=s.indexOf(m.value);m.value=s[(e+1)%s.length]},b=async()=>{try{await navigator.clipboard.writeText(`${a.value.title}

${a.value.content}`),alert("诗歌已复制到剪贴板")}catch(s){console.error("复制失败:",s)}},z=()=>{u.value=!u.value;const s=u.value?"已添加到收藏":"已从收藏中移除";alert(s)},F=()=>{navigator.share?navigator.share({title:a.value.title,text:a.value.description,url:window.location.href}):(b(),alert("链接已复制到剪贴板，可以分享给朋友"))},B=()=>{window.print()};return $(()=>{const s=parseInt(S.params.id);a.value=i.find(g=>g.id===s)||{},a.value.id||alert("诗歌不存在");const e=JSON.parse(localStorage.getItem("favorites")||"[]");u.value=e.includes(s);const c=JSON.parse(localStorage.getItem("viewHistory")||"[]"),n=[s,...c.filter(g=>g!==s)].slice(0,10);localStorage.setItem("viewHistory",JSON.stringify(n))}),(s,e)=>{const c=H("router-link");return o(),r("div",L,[t("div",j,[J(c,{to:"/poems",class:"back-button"},{default:v(()=>[...e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left"},null,-1),d(" 返回诗集 ",-1)])]),_:1})]),t("div",q,[t("div",E,[t("div",M,[t("div",R,[t("span",A,l(a.value.category),1),t("span",G,l(N(a.value.date)),1)]),t("h1",K,l(a.value.title),1),t("div",Q,[e[1]||(e[1]=t("i",{class:"fas fa-user"},null,-1)),d(" 作者: "+l(a.value.author),1)])]),t("div",U,[t("div",{class:x(["poem-text",[m.value,P(a.value.category)]])},[t("pre",null,l(a.value.content),1)],2),a.value.description?(o(),r("div",W,[e[2]||(e[2]=t("h3",null,[t("i",{class:"fas fa-info-circle"}),d(" 作品简介")],-1)),t("p",null,l(a.value.description),1)])):w("",!0)]),t("div",X,[e[3]||(e[3]=t("h3",null,[t("i",{class:"fas fa-tags"}),d(" 标签")],-1)),t("div",Y,[(o(!0),r(C,null,I(a.value.tags,n=>(o(),p(c,{key:n,to:{path:"/poems",query:{tag:n}},class:"tag"},{default:v(()=>[d(l(n),1)]),_:2},1032,["to"]))),128))])]),t("div",Z,[t("button",{class:"action-btn",onClick:D,title:"调整字体大小"},[...e[4]||(e[4]=[t("i",{class:"fas fa-text-height"},null,-1),t("span",null,"字体",-1)])]),t("button",{class:"action-btn",onClick:b,title:"复制全文"},[...e[5]||(e[5]=[t("i",{class:"far fa-copy"},null,-1),t("span",null,"复制",-1)])]),t("button",{class:"action-btn",onClick:z,title:"收藏"},[t("i",{class:x(u.value?"fas fa-heart":"far fa-heart")},null,2),e[6]||(e[6]=t("span",null,"收藏",-1))]),t("button",{class:"action-btn",onClick:F,title:"分享"},[...e[7]||(e[7]=[t("i",{class:"fas fa-share-alt"},null,-1),t("span",null,"分享",-1)])]),t("button",{class:"action-btn",onClick:B,title:"打印"},[...e[8]||(e[8]=[t("i",{class:"fas fa-print"},null,-1),t("span",null,"打印",-1)])])])]),t("div",tt,[f.value?(o(),p(c,{key:0,to:`/poem/${f.value.id}`,class:"nav-link prev"},{default:v(()=>[e[10]||(e[10]=t("i",{class:"fas fa-chevron-left"},null,-1)),t("div",et,[e[9]||(e[9]=t("span",{class:"nav-label"},"上一篇",-1)),t("span",st,l(f.value.title),1)])]),_:1},8,["to"])):(o(),r("div",at)),_.value?(o(),p(c,{key:2,to:`/poem/${_.value.id}`,class:"nav-link next"},{default:v(()=>[t("div",ot,[e[11]||(e[11]=t("span",{class:"nav-label"},"下一篇",-1)),t("span",lt,l(_.value.title),1)]),e[12]||(e[12]=t("i",{class:"fas fa-chevron-right"},null,-1))]),_:1},8,["to"])):(o(),r("div",nt))]),k.value.length>0?(o(),r("div",it,[e[13]||(e[13]=t("h2",null,"相关作品",-1)),t("div",rt,[(o(!0),r(C,null,I(k.value,n=>(o(),p(T,{key:n.id,poem:n},null,8,["poem"]))),128))])])):w("",!0)])])}}},pt=O(ct,[["__scopeId","data-v-5f7f18e1"]]);export{pt as default};
